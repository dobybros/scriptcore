<?xml version="1.0" encoding="utf-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:context="http://www.springframework.org/schema/context"
	   xmlns="http://www.springframework.org/schema/beans"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd   
           http://www.springframework.org/schema/context   
           http://www.springframework.org/schema/context/spring-context-3.0.xsd">
    <context:annotation-config />
    <bean id="springContextUtil" class="com.socialshops.chat.utils.SpringContextUtil"/>
	<bean id="ipHolder" class="com.socialshops.chat.server.IPHolder" init-method="init">
		<property name="ipPrefix" value="${server.ip.prefix}"></property>
		<property name="ethPrefix" value="${server.eth.prefix}"></property>
	</bean>
	
	<bean id="presenceServerRPCHandler" class="com.socialshops.chat.tasks.PresenceServerRPCHandler">
	</bean>
	
	<bean id="domainRouterService" class="com.socialshops.login.services.impl.DomainRouterService"></bean>
	
	<bean id="oauth2properties" class="com.socialshops.chat.utils.AutoReloadProperties"
		init-method="init">
		<property name="path" value="${oauth.path}" />
	</bean>

	<bean id="selectBestPresenceTask" class="com.socialshops.chat.tasks.SelectBestPresenceTask">
	</bean>

	<bean id="rpcClientAdapterMapTask" class="com.socialshops.chat.tasks.RPCClientAdapterMapTask">
		<!--<property name="enableSsl" value="true" />-->
		<!--<property name="rpcSslClientTrustJksPath" value="${rpc.ssl.clientTrust.jks.path}" />-->
		<!--<property name="rpcSslServerJksPath" value="${rpc.ssl.server.jks.path}" />-->
		<!--<property name="rpcSslJksPwd" value="${rpc.ssl.jks.pwd}" />-->
	</bean>
	<bean id="rpcClientAdapterMapTaskSsl" class="com.socialshops.chat.tasks.RPCClientAdapterMapTask">
		<property name="enableSsl" value="true" />
		<property name="rpcSslClientTrustJksPath" value="${rpc.ssl.clientTrust.jks.path}" />
		<property name="rpcSslServerJksPath" value="${rpc.ssl.server.jks.path}" />
		<property name="rpcSslJksPwd" value="${rpc.ssl.jks.pwd}" />
	</bean>
	<bean id="outsideLansTask" class="com.socialshops.chat.tasks.OutsideLansTask">
	</bean>
	<bean id="jsonFilterFactory" class="script.filter.JsonFilterFactory"></bean>
	<bean id="groovyBeanFactory" class="script.groovy.runtime.GroovyBeanFactory">
    </bean>
	<bean id="groovyRuntime" class="script.groovy.runtime.GroovyRuntime" init-method="init">
		<property name="annotationHandlers">
			<list>
				<ref bean="groovyBeanFactory"/>
				<ref bean="groovyServletManager"/>
				<ref bean="jsonFilterFactory" />
			</list>
		</property>
		<property name="path" value="${groovy.path}"/>
	</bean>
	<bean id="groovyServletManager" class="script.groovy.servlets.GroovyServletManager" init-method="initAsDefault">
	</bean>

	<bean id="onlineServer" class="com.socialshops.chat.onlineserver.OnlineServerWithStatus" init-method="start" destroy-method="shutdown">
		<!-- property name="server" value="fixname" /-->
		<property name="serverType" value="${server.type}" />
		<property name="internalKey" value="${internal.key}"/>
		<property name="tasks">
			<list>
				<ref bean="rpcClientAdapterMapTask"/>
				<ref bean="rpcClientAdapterMapTaskSsl" />
				<ref bean="selectBestPresenceTask"/>
				<ref bean="outsideLansTask" />
			</list>
		</property>
	</bean>
	<bean id="scriptManager" class="com.socialshops.chat.script.ScriptManager" init-method="init">
		<property name="localPath" value="${script.local.path}"/>
		<property name="remotePath" value="${script.remote.path}"/>
	</bean>
</beans>
